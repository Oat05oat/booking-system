<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏π‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ôGoodnotes 6</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap");

      body {
        font-family: "Sarabun", sans-serif;
        background-color: #f4f6f8;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
        padding: 20px 0;
      }

      .container {
        background-color: #fff;
        padding: 40px;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        text-align: center;
        max-width: 480px;
        width: 90%;
        transition: all 0.3s ease-in-out;
      }

      /* --- ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô --- */
      .login-view h1 {
        color: #3498db;
        margin-top: 0;
        margin-bottom: 20px;
      }
      .login-view p {
        color: #555;
        margin-bottom: 25px;
      }
      .instructions-box {
        background-color: #eaf4fd;
        border-left: 5px solid #3498db;
        border-radius: 6px;
        padding: 15px 20px;
        margin-bottom: 25px;
        text-align: left;
      }
      .instructions-box h3 {
        margin-top: 0;
        color: #2c7ab0;
        font-size: 1.1em;
      }
      .instructions-box ul {
        padding-left: 20px;
        margin-bottom: 0;
        color: #333;
      }
      .instructions-box li {
        margin-bottom: 8px;
        line-height: 1.5;
      }
      .login-view input[type="text"] {
        display: block;
        width: 100%;
        padding: 14px;
        margin-bottom: 20px;
        border: 1px solid #ddd;
        border-radius: 6px;
        box-sizing: border-box;
        font-size: 16px;
        font-family: "Sarabun", sans-serif;
      }
      .login-view button {
        background-color: #3498db;
        color: white;
        padding: 14px 25px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
        width: 100%;
        transition: background-color 0.3s ease;
      }
      .login-view button:hover {
        background-color: #2980b9;
      }

      /* --- ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• --- */
      .success-view {
        text-align: left;
      }
      .success-view h1 {
        color: #2ecc71;
        text-align: center;
        margin-top: 0;
        margin-bottom: 10px;
      }
      .status-verified {
        text-align: center;
        color: #27ae60;
        font-weight: bold;
        margin-bottom: 30px;
      }
      .credential-item {
        margin-bottom: 20px;
      }
      .credential-item label {
        display: block;
        color: #555;
        font-weight: bold;
        margin-bottom: 8px;
      }
      .credential-box {
        background-color: #f9f9f9;
        border: 1px solid #eee;
        border-radius: 6px;
        padding: 12px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .credential-value {
        font-size: 16px;
        color: #333;
        word-break: break-all;
        margin-right: 15px;
      }
      .copy-btn {
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 6px;
        padding: 10px 15px;
        cursor: pointer;
        font-size: 14px;
      }
      .link-instructions {
        text-align: center;
        margin-top: 30px;
      }
      .link-instructions a {
        color: #3498db;
        text-decoration: none;
        font-weight: bold;
        cursor: pointer; /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏°‡∏∑‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ä‡∏µ‡πâ */
      }
      hr {
        border: none;
        border-top: 1px solid #eee;
        margin: 35px 0;
      }
      .freebie-section {
        text-align: center;
      }
      .freebie-title {
        font-size: 1.2em;
        font-weight: bold;
        color: #e67e22;
        margin-bottom: 15px;
      }
      .freebie-box {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 10px;
        padding: 15px;
        border-radius: 8px;
      }
      .freebie-product {
        background-color: #fff8e1;
        color: #c27800;
        border: 1px dashed #f1c40f;
      }
      .freebie-none {
        background-color: #f3f4f6;
        color: #6b7280;
        justify-content: center;
      }
      .claim-btn {
        background-color: #e67e22;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 5px;
        cursor: pointer;
      }
      .logout-btn {
        display: block;
        width: 100%;
        box-sizing: border-box;
        background-color: #e74c3c;
        color: white;
        text-align: center;
        padding: 12px;
        border-radius: 6px;
        text-decoration: none;
        font-weight: bold;
        margin-top: 25px;
        cursor: pointer;
      }
      .swal-claim-box {
        margin-bottom: 1rem;
        text-align: left;
      }
      .swal-claim-label {
        font-weight: bold;
        color: #555;
        display: block;
        margin-bottom: 0.25rem;
      }
      .swal-claim-value {
        background: #f1f1f1;
        padding: 8px 12px;
        border-radius: 4px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .swal-copy-btn {
        background: #3498db;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 5px 10px;
        font-size: 12px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="container" id="main-container"></div>

    <script>
      // ==========================================================
      //  ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç! ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç API URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
      // ==========================================================
      const API_URL =
        "https://script.google.com/macros/s/AKfycbzTZHRMZDCAL3uh5q40scqkYjl2U9jGhxYmKwTg4WrwQPdeF7M66P6Eb_rYETcGlOiC/exec";

      const mainContainer = document.getElementById("main-container");

      function renderLoginView() {
        mainContainer.className = "container login-view";
        mainContainer.innerHTML = `
                <h1>‡∏î‡∏π‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô Goodnotes 6</h1>
                <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ü‡∏£‡∏µ</p>
                <div class="instructions-box">
                    <h3>üí° ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h3>
                    <ul>
                        <li>‡∏Å‡∏£‡∏≠‡∏Å <strong>‡∏ä‡∏∑‡πà‡∏≠</strong> ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏ß‡πâ‡πÉ‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Ñ‡∏•‡∏°</li>
                        <li>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏™‡∏∞‡∏Å‡∏î‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏£‡∏£‡∏Ñ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô</li>
                        <li>‡∏´‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡πÄ‡∏à‡πâ‡∏á‡∏ß‡πà‡∏≤ <strong>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</strong> ‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡πÄ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞</li>
                        <li>‡∏´‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡πÄ‡∏à‡πâ‡∏á‡∏ß‡πà‡∏≤ <strong>‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</strong> ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡πÄ‡∏à‡πâ‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô/‡∏á‡∏î‡∏ß‡∏µ‡∏ô</li>
                    </ul>
                </div>
                <form id="loginForm">
                    <input type="text" id="customerName" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà" required>
                    <button type="submit">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
                </form>
            `;
        document
          .getElementById("loginForm")
          .addEventListener("submit", handleLogin);
      }

      function renderSuccessView(userData, freebieData) {
        mainContainer.className = "container success-view";
        const freebieHtml = freebieData
          ? `
                <div class="freebie-box freebie-product">
                    <span>${freebieData.productName}</span>
                    <button class="claim-btn" onclick="claimFreebie('${freebieData.productName}', '${freebieData.email}', '${freebieData.password}')">‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á</button>
                </div>`
          : `<div class="freebie-box freebie-none">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ü‡∏£‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ</div>`;

        mainContainer.innerHTML = `
                <h1>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö</h1>
                <div class="status-verified">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÅ‡∏•‡πâ‡∏ß</div>
                <div class="credential-item">
                    <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏• (Goodnotes):</label>
                    <div class="credential-box"><span>${userData.email}</span><button class="copy-btn" onclick="copyToClipboard('‡∏≠‡∏µ‡πÄ‡∏°‡∏• Goodnotes', '${userData.email}')">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button></div>
                </div>
                <div class="credential-item">
                    <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Goodnotes):</label>
                    <div class="credential-box"><span>${userData.password}</span><button class="copy-btn" onclick="copyToClipboard('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô Goodnotes', '${userData.password}')">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button></div>
                </div>
                <div class="link-instructions"><a onclick="showHelpVideo()">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</a></div>
                <hr>
                <div class="freebie-section">
                    <div class="freebie-title">üéÅ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ü‡∏£‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì</div>
                    ${freebieHtml}
                </div>
                <a onclick="logout()" class="logout-btn">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a>
            `;
      }

      async function handleLogin(event) {
        event.preventDefault();
        const name = document.getElementById("customerName").value;

        Swal.fire({
          title: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
          didOpen: () => {
            Swal.showLoading();
          },
        });

        try {
          const response = await fetch(API_URL, {
            method: "POST",
            mode: "cors",
            redirect: "follow",
            body: JSON.stringify({ name: name }),
            headers: { "Content-Type": "text/plain;charset=utf-8" },
          });

          const result = await response.json();
          Swal.close();

          if (result.status === "success") {
            renderSuccessView(result.userData, result.freebieData);
          } else if (result.status === "unverified") {
            Swal.fire("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô", result.message, "warning");
          } else {
            Swal.fire("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", result.message, "error");
          }
        } catch (error) {
          Swal.fire("‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", error.toString(), "error");
        }
      }

      function copyToClipboard(typeName, textToCopy) {
        navigator.clipboard.writeText(textToCopy).then(() => {
          Swal.fire({
            icon: "success",
            title: "‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!",
            text: `${typeName} ‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢`,
            timer: 1500,
            showConfirmButton: false,
          });
        });
      }

      function claimFreebie(productName, email, password) {
        Swal.fire({
          icon: "success",
          title: "‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ü‡∏£‡∏µ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!",
          html: `
                  <p>‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö <strong>${productName}</strong> ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
                  <hr>
                  <p>‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</p>
                  <div class="swal-claim-box">
                    <label class="swal-claim-label">‡∏≠‡∏µ‡πÄ‡∏°‡∏•:</label>
                    <div class="swal-claim-value">
                      <span>${email}</span>
                      <button class="swal-copy-btn" onclick="copyToClipboard('‡∏≠‡∏µ‡πÄ‡∏°‡∏•', '${email}')">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
                    </div>
                  </div>
                  <div class="swal-claim-box">
                    <label class="swal-claim-label">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô:</label>
                    <div class="swal-claim-value">
                      <span>${password}</span>
                      <button class="swal-copy-btn" onclick="copyToClipboard('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô', '${password}')">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
                    </div>
                  </div>
                `,
          confirmButtonText: "‡∏õ‡∏¥‡∏î",
        });
      }

      function logout() {
        Swal.fire({
          title: "‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
          icon: "success",
          timer: 1000,
          showConfirmButton: false,
          willClose: () => {
            renderLoginView();
          },
        });
      }

      // ========== ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç 2: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ ==========
      function showHelpVideo() {
        // ‡πÅ‡∏õ‡∏•‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå Google Drive ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ù‡∏±‡∏á (embed)
        const videoId = "1AdEoE6-xMx1osHX-1pjDYGbXEsT47PSj";
        const embedUrl = `https://drive.google.com/file/d/${videoId}/preview`;

        Swal.fire({
          title: "‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô",
          html: `<iframe src="${embedUrl}" width="100%" height="400" frameborder="0" allowfullscreen></iframe>`,
          width: "90%",
          padding: "1em",
          showCloseButton: true,
          showConfirmButton: false,
        });
      }

      renderLoginView();
    </script>
  </body>
</html>
